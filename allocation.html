<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ClassForge Group Allocation - Configure and run classroom optimization algorithms using genetic algorithms with social network analysis">
    <meta name="keywords" content="classroom allocation, genetic algorithm, student grouping, optimization">
    <meta name="author" content="ClassForge Team">
    
    <!-- Performance optimization -->
    <meta name="robots" content="noindex, nofollow">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    
    <title>ClassForge - Group Allocation</title>
    
    <!-- Critical CSS -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="allocation.css">
    
    <!-- Non-critical font loading -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Accessibility and performance -->
    <meta name="theme-color" content="#4299e1">
    <meta name="color-scheme" content="light">
</head>
<body>
    <div class="container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar" role="navigation" aria-label="Main navigation">
            <div class="logo">
                <h1>ClassForge</h1>
            </div>
            <ul class="nav-links">
                <li><a href="index.html" aria-label="Overview dashboard"><span class="icon" aria-hidden="true">üìä</span> Overview</a></li>
                <li><a href="upload.html" aria-label="Upload data and simulate"><span class="icon" aria-hidden="true">üì§</span> Upload & Simulate</a></li>
                <li><a href="student-explorer.html" aria-label="Explore student data"><span class="icon" aria-hidden="true">üë•</span> Student Explorer</a></li>
                <li class="active"><a href="allocation.html" aria-current="page" aria-label="Group allocation configuration"><span class="icon" aria-hidden="true">üéØ</span> Group Allocation</a></li>
                <li><a href="classroom.html" aria-label="View classroom layout"><span class="icon" aria-hidden="true">üè´</span> Classroom View</a></li>
                <li><a href="overrides.html" aria-label="Manual allocation overrides"><span class="icon" aria-hidden="true">‚öôÔ∏è</span> Manual Overrides</a></li>
                <li><a href="settings.html" aria-label="Application settings"><span class="icon" aria-hidden="true">‚öôÔ∏è</span> Settings</a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content" role="main">
            <header class="top-bar fade-in">
                <div class="header-content">
                    <h2>Group Allocation</h2>
                    <p class="subtitle">Configure and run classroom optimization algorithms</p>
                </div>
                <div class="user-info">
                    <span class="user-name">Admin User</span>
                    <span class="user-avatar" aria-label="User avatar">üë§</span>
                </div>
            </header>

            <div class="allocation-container slide-up">
                <!-- Strategy Selector Section -->
                <section class="strategy-section" aria-labelledby="strategy-heading">
                    <h3 id="strategy-heading">üéØ Allocation Strategy</h3>
                    <div class="strategy-options" role="radiogroup" aria-labelledby="strategy-heading">
                        <div class="strategy-card" data-strategy="genetic">
                            <input type="radio" name="strategy" id="genetic" value="genetic" checked disabled aria-describedby="genetic-desc">
                            <label for="genetic">
                                <h4>Genetic Algorithm</h4>
                                <p id="genetic-desc">Advanced optimization using evolutionary algorithms (sole method used by this system)</p>
                            </label>
                        </div>
                    </div>
                </section>

                <!-- Model Parameters Section -->
                <section class="parameters-section">
                    <h3>‚öôÔ∏è Model Parameters</h3>

                    <!-- Genetic Algorithm Parameters -->
                    <div class="parameter-group" id="genetic-params">
                        <div class="parameter-card">
                            <label for="populationSize">Population Size</label>
                            <input type="number" id="populationSize" min="50" max="200" value="100">
                        </div>
                        <div class="parameter-card">
                            <label for="generations">Number of Generations</label>
                            <input type="number" id="generations" min="50" max="500" value="200">
                        </div>
                        <div class="parameter-card">
                            <label for="mutationRate">Mutation Rate</label>
                            <input type="range" id="mutationRate" min="1" max="20" value="5">
                            <span class="slider-value">5%</span>
                        </div>
                        <div class="parameter-card">
                            <label for="maxClassSize">Maximum Class Size</label>
                            <input type="number" id="maxClassSize" min="15" max="40" value="25">
                        </div>
                        <div class="parameter-card">
                            <label for="academicBalanceWeight">Academic Balance Weight</label>
                            <input type="range" id="academicBalanceWeight" min="0" max="1" step="0.1" value="0.5">
                            <span class="slider-value">0.5</span>
                        </div>
                        <div class="parameter-card">
                            <label for="wellbeingBalanceWeight">Wellbeing Balance Weight</label>
                            <input type="range" id="wellbeingBalanceWeight" min="0" max="1" step="0.1" value="0.5">
                            <span class="slider-value">0.5</span>
                        </div>
                        <div class="parameter-card">
                            <label for="maxBulliesPerClass">Max Bullies Per Class (Score > 7)</label>
                            <input type="number" id="maxBulliesPerClass" min="0" max="5" value="2">
                        </div>
                        <div class="parameter-card">
                            <label for="maxFriendsSplit">Max Friends Split (Pairs)</label>
                            <input type="number" id="maxFriendsSplit" min="0" max="10" value="2">
                        </div>
                    </div>
                </section>

                <!-- Run Allocation Section -->
                <section class="run-section">
                    <h3>‚ñ∂Ô∏è Run Allocation</h3>
                    <div class="run-container">
                        <button id="runAllocation" class="run-button">
                            <span class="icon">‚ñ∂Ô∏è</span>
                            Run Allocation
                        </button>
                        
                        <!-- Progress Indicator -->
                        <div id="progressIndicator" class="progress-indicator" style="display: none;">
                            <div class="progress-bar">
                                <div class="progress-fill"></div>
                            </div>
                            <p class="progress-text">Optimizing classroom assignments...</p>
                        </div>

                        <!-- Results Summary -->
                        <div id="resultsSummary" class="results-summary" style="display: none;">
                            <div class="success-message">
                                <span class="icon">‚úÖ</span>
                                <h4>Allocation Complete</h4>
                            </div>
                            <div class="metrics-grid">
                                <div class="metric-card">
                                    <h5>Total Students</h5>
                                    <div class="metric-value" id="resultsTotalStudents">-</div>
                                </div>
                                <div class="metric-card">
                                    <h5>Classes Created</h5>
                                    <div class="metric-value" id="resultsNumClasses">-</div>
                                </div>
                                <div class="metric-card">
                                    <h5>Avg Academic Score</h5>
                                    <div class="metric-value" id="resultsAvgAcademic">-</div>
                                </div>
                                <div class="metric-card">
                                    <h5>Avg Wellbeing</h5>
                                    <div class="metric-value" id="resultsAvgWellbeing">-</div>
                                </div>
                                <div class="metric-card">
                                    <h5>Balance Score</h5>
                                    <div class="metric-value" id="balance-score">-</div>
                                </div>
                                <div class="metric-card">
                                    <h5>Diversity Score</h5>
                                    <div class="metric-value" id="diversity-score">-</div>
                                </div>
                                <div class="metric-card">
                                    <h5>Constraint Satisfaction</h5>
                                    <div class="metric-value" id="constraint-satisfaction">-</div>
                                </div>
                                <div class="metric-card">
                                    <h5>Processing Time</h5>
                                    <div class="metric-value" id="processing-time">-</div>
                                </div>
                            </div>
                            <div class="constraint-violations" id="constraintViolations">
                                <h5>Constraint Violations</h5>
                                <ul id="violationsList"></ul>
                            </div>
                            <!-- Add table for detailed results -->
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Class</th>
                                            <th>Students</th>
                                            <th>Avg Academic</th>
                                            <th>Avg Wellbeing</th>
                                        </tr>
                                    </thead>
                                    <tbody id="resultsTableBody">
                                        <!-- Rows will be dynamically populated -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Footer Navigation -->
            <div class="action-buttons fade-in">
                <button class="action-btn" onclick="window.location.href='index.html'">
                    <span class="icon">‚Ü©</span> Back to Overview
                </button>
                <button class="action-btn" onclick="window.location.href='classroom.html'" id="viewClassroomBtn" disabled>
                    <span class="icon">üè´</span> View Classroom Assignments
                </button>
            </div>
        </main>
    </div>
    <script src="allocation.js"></script>
</body>
</html>